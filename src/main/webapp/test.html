<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>获取选择框选择的索引</title>
</head>
<body>
<select name="selectedIndices" id="selectedIndices" multiple>
    <option value="file1">加密主要铁路1727272532433.shp</option>
    <option value="file2">加密test1727272532433.shp</option>
    <option value="file2">加密test1727272532433.shp</option>
</select>
<button id="submit">提交</button>

<script>
    document.getElementById('submit').addEventListener('click', function() {
        const select = document.getElementById('selectedIndices');
        const selectedOptions = Array.from(select.selectedOptions);
        const indices = [];

        // 用于计算相同文件名选项的相对索引
        const occurrences = {};

        // 遍历所有选项
        Array.from(select.options).forEach((option, index) => {
            const text = option.textContent;

            // 如果该选项被选中
            if (selectedOptions.includes(option)) {
                if (!occurrences[text]) {
                    occurrences[text] = 0; // 初始化计数
                }

                // 如果是选中的文件名的次出现，则添加相对索引
                if (occurrences[text] < selectedOptions.filter(o => o.textContent === text).length) {
                    indices.push(occurrences[text]); // 将相对索引添加到结果
                    occurrences[text]++; // 对该文本计数增加
                }
            }
        });

        console.log(indices); // 输出相对索引，例如: [0, 1]
    });
</script>
</body>
</html>